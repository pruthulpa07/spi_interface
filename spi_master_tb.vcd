$date
	Tue May 21 19:56:34 2024
$end
$version
	Icarus Verilog
$end
$timescale
	1ps
$end
$scope module tb_spi_master $end
$var wire 1 ! tx_ready_o $end
$var wire 1 " spi_mosi_o $end
$var wire 1 # spi_clk_o $end
$var wire 1 $ rx_data_valid_o $end
$var wire 8 % rx_data_byte_o [7:0] $end
$var parameter 32 & CLK_RATIO $end
$var parameter 32 ' PERIOD $end
$var parameter 32 ( SPI_MODE $end
$var reg 1 ) clk_i $end
$var reg 1 * reset_l_i $end
$var reg 1 + spi_miso_i $end
$var reg 8 , tx_data_byte_i [7:0] $end
$var reg 1 - tx_data_valid_i $end
$scope module u_spi_master $end
$var wire 1 . CPHA_s $end
$var wire 1 / CPOL_s $end
$var wire 1 ) clk_i $end
$var wire 1 * reset_l_i $end
$var wire 8 0 tx_data_byte_i [7:0] $end
$var wire 1 - tx_data_valid_i $end
$var wire 1 " spi_miso_i $end
$var wire 1 # spi_clk_o $end
$var parameter 32 1 CLK_RATIO $end
$var parameter 32 2 SPI_MODE $end
$var reg 3 3 clk_counter_r [2:0] $end
$var reg 1 4 leading_edge_r $end
$var reg 3 5 rx_count_r [2:0] $end
$var reg 8 6 rx_data_byte_o [7:0] $end
$var reg 1 $ rx_data_valid_o $end
$var reg 3 7 spi_clk_counter_r [2:0] $end
$var reg 1 8 spi_clk_enable_r $end
$var reg 1 " spi_mosi_o $end
$var reg 1 9 sub_clock_r $end
$var reg 1 : trailing_edge_r $end
$var reg 3 ; tx_count_r [2:0] $end
$var reg 8 < tx_data_byte_r [7:0] $end
$var reg 1 = tx_data_valid_r $end
$var reg 1 ! tx_ready_o $end
$upscope $end
$scope task SendSingleByte $end
$var reg 8 > data [7:0] $end
$upscope $end
$upscope $end
$enddefinitions $end
$comment Show the parameter values. $end
$dumpall
b0 2
b100 1
b0 (
b101000 '
b100 &
$end
#0
$dumpvars
bx >
x=
bx <
bx ;
x:
x9
x8
bx 7
bx 6
bx 5
x4
bx 3
b0 0
0/
0.
0-
b0 ,
0+
0*
0)
bx %
x$
x#
x"
x!
$end
#20000
b0 7
0#
b0 3
09
1:
04
08
1!
0=
b0 <
b111 ;
0"
b111 5
0$
b0 %
b0 6
1)
#40000
0)
#60000
1:
1)
#80000
0)
b11000001 >
1*
#100000
b1 3
0:
1-
b11000001 ,
b11000001 0
1)
#120000
0)
#140000
b1 7
b11000001 <
1=
18
0!
b10 3
0-
1)
#160000
0)
#180000
b11 3
0=
b110 ;
1"
1)
#200000
0)
#220000
b10 7
1#
14
19
b0 3
1)
#240000
0)
#260000
b1 3
04
b110 5
b10000000 %
b10000000 6
1)
#280000
0)
#300000
b10 3
1)
#320000
0)
#340000
b11 3
1)
#360000
0)
#380000
0#
1:
09
b0 3
1)
#400000
0)
#420000
b1 3
0:
b101 ;
1)
#440000
0)
#460000
b10 3
1)
#480000
0)
#500000
b11 3
1)
#520000
0)
#540000
b11 7
1#
14
19
b0 3
1)
#560000
0)
#580000
b1 3
04
b101 5
b11000000 %
b11000000 6
1)
#600000
0)
#620000
b10 3
1)
#640000
0)
#660000
b11 3
1)
#680000
0)
#700000
0#
1:
09
b0 3
1)
#720000
0)
#740000
b1 3
0:
0"
b100 ;
1)
#760000
0)
#780000
b10 3
1)
#800000
0)
#820000
b11 3
1)
#840000
0)
#860000
b100 7
1#
14
19
b0 3
1)
#880000
0)
#900000
b1 3
04
b100 5
1)
#920000
0)
#940000
b10 3
1)
#960000
0)
#980000
b11 3
1)
#1000000
0)
#1020000
0#
1:
09
b0 3
1)
#1040000
0)
#1060000
b1 3
0:
b11 ;
1)
#1080000
0)
#1100000
b10 3
1)
#1120000
0)
#1140000
b11 3
1)
#1160000
0)
#1180000
b101 7
1#
14
19
b0 3
1)
#1200000
0)
#1220000
b1 3
04
b11 5
1)
#1240000
0)
#1260000
b10 3
1)
#1280000
0)
#1300000
b11 3
1)
#1320000
0)
#1340000
0#
1:
09
b0 3
1)
#1360000
0)
#1380000
b1 3
0:
b10 ;
1)
#1400000
0)
#1420000
b10 3
1)
#1440000
0)
#1460000
b11 3
1)
#1480000
0)
#1500000
b110 7
1#
14
19
b0 3
1)
#1520000
0)
#1540000
b1 3
04
b10 5
1)
#1560000
0)
#1580000
b10 3
1)
#1600000
0)
#1620000
b11 3
1)
#1640000
0)
#1660000
0#
1:
09
b0 3
1)
#1680000
0)
#1700000
b1 3
0:
b1 ;
1)
#1720000
0)
#1740000
b10 3
1)
#1760000
0)
#1780000
b11 3
1)
#1800000
0)
#1820000
b111 7
1#
14
19
b0 3
1)
#1840000
0)
#1860000
b0 7
0#
b10111110 >
b1 3
04
08
1!
b1 5
1)
#1880000
0)
#1900000
b111 5
b111 ;
b10 3
1-
b10111110 ,
b10111110 0
1)
#1920000
0)
#1940000
b1 7
1#
b11 3
18
0!
b10111110 <
1=
0-
1)
#1960000
0)
#1980000
0#
b110 ;
1"
0=
1:
09
b0 3
1)
#2000000
0)
#2020000
b1 3
0:
0"
b101 ;
1)
#2040000
0)
#2060000
b10 3
1)
#2080000
0)
#2100000
b11 3
1)
#2120000
0)
#2140000
b10 7
1#
14
19
b0 3
1)
#2160000
0)
#2180000
b1 3
04
b110 5
b1000000 %
b1000000 6
1)
#2200000
0)
#2220000
b10 3
1)
#2240000
0)
#2260000
b11 3
1)
#2280000
0)
#2300000
0#
1:
09
b0 3
1)
#2320000
0)
#2340000
b1 3
0:
1"
b100 ;
1)
#2360000
0)
#2380000
b10 3
1)
#2400000
0)
#2420000
b11 3
1)
#2440000
0)
#2460000
b11 7
1#
14
19
b0 3
1)
#2480000
0)
#2500000
b1 3
04
b101 5
1)
#2520000
0)
#2540000
b10 3
1)
#2560000
0)
#2580000
b11 3
1)
#2600000
0)
#2620000
0#
1:
09
b0 3
1)
#2640000
0)
#2660000
b1 3
0:
b11 ;
1)
#2680000
0)
#2700000
b10 3
1)
#2720000
0)
#2740000
b11 3
1)
#2760000
0)
#2780000
b100 7
1#
14
19
b0 3
1)
#2800000
0)
#2820000
b1 3
04
b100 5
b1100000 %
b1100000 6
1)
#2840000
0)
#2860000
b10 3
1)
#2880000
0)
#2900000
b11 3
1)
#2920000
0)
#2940000
0#
1:
09
b0 3
1)
#2960000
0)
#2980000
b1 3
0:
b10 ;
1)
#3000000
0)
#3020000
b10 3
1)
#3040000
0)
#3060000
b11 3
1)
#3080000
0)
#3100000
b101 7
1#
14
19
b0 3
1)
#3120000
0)
#3140000
b1 3
04
b11 5
b1110000 %
b1110000 6
1)
#3160000
0)
#3180000
b10 3
1)
#3200000
0)
#3220000
b11 3
1)
#3240000
0)
#3260000
0#
1:
09
b0 3
1)
#3280000
0)
#3300000
b1 3
0:
b1 ;
1)
#3320000
0)
#3340000
b10 3
1)
#3360000
0)
#3380000
b11 3
1)
#3400000
0)
#3420000
b110 7
1#
14
19
b0 3
1)
#3440000
0)
#3460000
b1 3
04
b10 5
b1111000 %
b1111000 6
1)
#3480000
0)
#3500000
b10 3
1)
#3520000
0)
#3540000
b11 3
1)
#3560000
0)
#3580000
0#
1:
09
b0 3
1)
#3600000
0)
#3620000
b1 3
0:
b0 ;
1)
#3640000
0)
#3660000
b10 3
1)
#3680000
0)
#3700000
b11 3
1)
#3720000
0)
#3740000
b111 7
1#
14
19
b0 3
1)
#3760000
0)
#3780000
b0 7
0#
b11101111 >
b1 3
04
08
1!
b1 5
b1111100 %
b1111100 6
1)
#3800000
0)
#3820000
b111 5
b111 ;
b10 3
1-
b11101111 ,
b11101111 0
1)
#3840000
0)
#3860000
b1 7
1#
b11 3
18
0!
b11101111 <
1=
0-
1)
#3880000
0)
#3900000
0#
b110 ;
0=
1:
09
b0 3
1)
#3920000
0)
#3940000
b1 3
0:
b101 ;
1)
#3960000
0)
#3980000
b10 3
1)
#4000000
0)
#4020000
b11 3
1)
#4040000
0)
#4060000
b10 7
1#
14
19
b0 3
1)
#4080000
0)
#4100000
b1 3
04
b110 5
b11111100 %
b11111100 6
1)
#4120000
0)
#4140000
b10 3
1)
#4160000
0)
#4180000
b11 3
1)
#4200000
0)
#4220000
0#
1:
09
b0 3
1)
#4240000
0)
#4260000
b1 3
0:
b100 ;
1)
#4280000
0)
#4300000
b10 3
1)
#4320000
0)
#4340000
b11 3
1)
#4360000
0)
#4380000
b11 7
1#
14
19
b0 3
1)
#4400000
0)
#4420000
b1 3
04
b101 5
1)
#4440000
0)
#4460000
b10 3
1)
#4480000
0)
#4500000
b11 3
1)
#4520000
0)
#4540000
0#
1:
09
b0 3
1)
#4560000
0)
#4580000
b1 3
0:
0"
b11 ;
1)
#4600000
0)
#4620000
b10 3
1)
#4640000
0)
#4660000
b11 3
1)
#4680000
0)
#4700000
b100 7
1#
14
19
b0 3
1)
#4720000
0)
#4740000
b1 3
04
b100 5
b11011100 %
b11011100 6
1)
#4760000
0)
#4780000
b10 3
1)
#4800000
0)
#4820000
b11 3
1)
#4840000
0)
#4860000
0#
1:
09
b0 3
1)
#4880000
0)
#4900000
b1 3
0:
1"
b10 ;
1)
#4920000
0)
#4940000
b10 3
1)
#4960000
0)
#4980000
b11 3
1)
#5000000
0)
#5020000
b101 7
1#
14
19
b0 3
1)
#5040000
0)
#5060000
b1 3
04
b11 5
1)
#5080000
0)
#5100000
b10 3
1)
#5120000
0)
#5140000
b11 3
1)
#5160000
0)
#5180000
0#
1:
09
b0 3
1)
#5200000
0)
#5220000
b1 3
0:
b1 ;
1)
#5240000
0)
#5260000
b10 3
1)
#5280000
0)
#5300000
b11 3
1)
#5320000
0)
#5340000
b110 7
1#
14
19
b0 3
1)
#5360000
0)
#5380000
b1 3
04
b10 5
1)
#5400000
0)
#5420000
b10 3
1)
#5440000
0)
#5460000
b11 3
1)
#5480000
0)
#5500000
0#
1:
09
b0 3
1)
#5520000
0)
#5540000
b1 3
0:
b0 ;
1)
#5560000
0)
#5580000
b10 3
1)
#5600000
0)
#5620000
b11 3
1)
#5640000
0)
#5660000
b111 7
1#
14
19
b0 3
1)
#5680000
0)
#5700000
b0 7
0#
b1 3
04
08
1!
b1 5
1)
#5720000
0)
#5740000
b111 5
b111 ;
b10 3
1)
#5760000
0)
#5780000
b11 3
1)
#5800000
0)
#5820000
1:
09
b0 3
1)
#5840000
0)
#5860000
b1 3
0:
1)
#5880000
0)
#5900000
b10 3
1)
#5920000
0)
#5940000
b11 3
1)
#5960000
0)
#5980000
14
19
b0 3
1)
#6000000
0)
#6020000
b1 3
04
1)
#6040000
0)
#6060000
b10 3
1)
#6080000
0)
#6100000
b11 3
1)
#6120000
0)
#6140000
1:
09
b0 3
1)
#6160000
0)
#6180000
b1 3
0:
1)
#6200000
0)
#6220000
b10 3
1)
#6240000
0)
#6260000
b11 3
1)
#6280000
0)
#6300000
14
19
b0 3
1)
#6320000
0)
#6340000
b1 3
04
1)
#6360000
0)
#6380000
b10 3
1)
#6400000
0)
#6420000
b11 3
1)
#6440000
0)
#6460000
1:
09
b0 3
1)
#6480000
0)
#6500000
b1 3
0:
1)
#6520000
0)
#6540000
b10 3
1)
#6560000
0)
#6580000
b11 3
1)
#6600000
0)
#6620000
14
19
b0 3
1)
#6640000
0)
#6660000
b1 3
04
1)
#6680000
0)
#6700000
b10 3
1)
#6720000
0)
#6740000
b11 3
1)
#6760000
0)
#6780000
1:
09
b0 3
1)
#6800000
0)
#6820000
b1 3
0:
1)
#6840000
0)
#6860000
b10 3
1)
#6880000
0)
#6900000
b11 3
1)
#6920000
0)
#6940000
14
19
b0 3
1)
#6960000
0)
#6980000
b1 3
04
1)
#7000000
0)
#7020000
b10 3
1)
#7040000
0)
#7060000
b11 3
1)
#7080000
0)
#7100000
1:
09
b0 3
1)
#7120000
0)
#7140000
b1 3
0:
1)
#7160000
0)
#7180000
b10 3
1)
#7200000
0)
#7220000
b11 3
1)
#7240000
0)
#7260000
14
19
b0 3
1)
#7280000
0)
#7300000
b1 3
04
1)
#7320000
0)
#7340000
b10 3
1)
#7360000
0)
#7380000
b11 3
1)
#7400000
0)
#7420000
1:
09
b0 3
1)
#7440000
0)
#7460000
b1 3
0:
1)
#7480000
0)
#7500000
b10 3
1)
#7520000
0)
#7540000
b11 3
1)
#7560000
0)
#7580000
14
19
b0 3
1)
#7600000
0)
#7620000
b1 3
04
1)
#7640000
0)
#7660000
b10 3
1)
#7680000
0)
#7700000
b11 3
1)
#7720000
0)
#7740000
1:
09
b0 3
1)
#7760000
0)
#7780000
b1 3
0:
1)
#7800000
0)
#7820000
b10 3
1)
#7840000
0)
#7860000
b11 3
1)
#7880000
0)
#7900000
14
19
b0 3
1)
#7920000
0)
#7940000
b1 3
04
1)
#7960000
0)
#7980000
b10 3
1)
#8000000
0)
#8020000
b11 3
1)
#8040000
0)
#8060000
1:
09
b0 3
1)
#8080000
0)
#8100000
b1 3
0:
1)
#8120000
0)
#8140000
b10 3
1)
#8160000
0)
#8180000
b11 3
1)
#8200000
0)
#8220000
14
19
b0 3
1)
#8240000
0)
#8260000
b1 3
04
1)
#8280000
0)
#8300000
b10 3
1)
#8320000
0)
#8340000
b11 3
1)
#8360000
0)
#8380000
1:
09
b0 3
1)
#8400000
0)
#8420000
b1 3
0:
1)
#8440000
0)
#8460000
b10 3
1)
#8480000
0)
#8500000
b11 3
1)
#8520000
0)
#8540000
14
19
b0 3
1)
#8560000
0)
#8580000
b1 3
04
1)
#8600000
0)
#8620000
b10 3
1)
#8640000
0)
#8660000
b11 3
1)
#8680000
0)
#8700000
1:
09
b0 3
1)
#8720000
0)
#8740000
b1 3
0:
1)
#8760000
0)
#8780000
b10 3
1)
#8800000
0)
#8820000
b11 3
1)
#8840000
0)
#8860000
14
19
b0 3
1)
#8880000
0)
#8900000
b1 3
04
1)
#8920000
0)
#8940000
b10 3
1)
#8960000
0)
#8980000
b11 3
1)
#9000000
0)
#9020000
1:
09
b0 3
1)
#9040000
0)
#9060000
b1 3
0:
1)
#9080000
0)
#9100000
b10 3
1)
#9120000
0)
#9140000
b11 3
1)
#9160000
0)
#9180000
14
19
b0 3
1)
#9200000
0)
#9220000
b1 3
04
1)
#9240000
0)
#9260000
b10 3
1)
#9280000
0)
#9300000
b11 3
1)
#9320000
0)
#9340000
1:
09
b0 3
1)
#9360000
0)
#9380000
b1 3
0:
1)
#9400000
0)
#9420000
b10 3
1)
#9440000
0)
#9460000
b11 3
1)
#9480000
0)
#9500000
14
19
b0 3
1)
#9520000
0)
#9540000
b1 3
04
1)
#9560000
0)
#9580000
b10 3
1)
#9600000
0)
#9620000
b11 3
1)
#9640000
0)
#9660000
1:
09
b0 3
1)
#9680000
0)
#9700000
b1 3
0:
1)
#9720000
0)
#9740000
b10 3
1)
#9760000
0)
#9780000
b11 3
1)
#9800000
0)
#9820000
14
19
b0 3
1)
#9840000
0)
#9860000
b1 3
04
1)
#9880000
0)
#9900000
b10 3
1)
#9920000
0)
#9940000
b11 3
1)
#9960000
0)
#9980000
1:
09
b0 3
1)
#10000000
0)
#10020000
b1 3
0:
1)
#10040000
0)
#10060000
b10 3
1)
#10080000
0)
#10100000
b11 3
1)
